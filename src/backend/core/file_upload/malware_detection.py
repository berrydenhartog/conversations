"""Malware detection callbacks"""

import logging

from django.utils.module_loading import import_string

from lasuite.malware_detection.enums import ReportStatus

logger = logging.getLogger(__name__)


def malware_detection_callback(  # noqa: PLR0913  # pylint: disable=too-many-arguments
    file_path, status, error_info, *, safe_callback, unknown_callback, unsafe_callback, **kwargs
):
    """Malware detection callback"""

    if status == ReportStatus.SAFE:
        _safe_callback = import_string(safe_callback)
        _safe_callback(file_path, **kwargs)
        return

    if status == ReportStatus.UNKNOWN:
        _unknown_callback = import_string(unknown_callback)
        if _unknown_callback(file_path, error_info, **kwargs):
            return

    _unsafe_callback = import_string(unsafe_callback)
    _unsafe_callback(file_path, error_info, **kwargs)
